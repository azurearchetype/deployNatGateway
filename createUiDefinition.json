{
  "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
  "handler": "Microsoft.Azure.CreateUIDef",
  "version": "0.1.2-preview",
  "parameters": {
    "basics": [
      {
        "name": "vnetSelector",
        "type": "Microsoft.Common.ResourceScope",
        "label": "Select Virtual Network",
        "toolTip": "Choose an existing virtual network.",
        "resourceTypes": [
          "Microsoft.Network/virtualNetworks"
        ],
        "constraints": {
          "required": true,
          "locationFilter": "[resourceGroup().location]"
        },
        "visible": true
      },
      {
        "name": "subnetSelector1",
        "type": "Microsoft.Common.DropDown",
        "label": "Select First Subnet",
        "toolTip": "Choose a subnet from the selected virtual network.",
        "constraints": {
          "allowedValues": "[map(reference(basics('vnetSelector').id, '2023-09-01').properties.subnets, subnet => { 'label': subnet.name, 'value': subnet.name })]",
          "required": true
        },
        "visible": true
      },
      {
        "name": "subnetSelector2",
        "type": "Microsoft.Common.DropDown",
        "label": "Select Second Subnet (Optional)",
        "toolTip": "Choose another subnet, if needed.",
        "constraints": {
          "allowedValues": "[map(reference(basics('vnetSelector').id, '2023-09-01').properties.subnets, subnet => { 'label': subnet.name, 'value': subnet.name })]",
          "required": false
        },
        "visible": true
      }
    ],
    "steps": [],
    "outputs": {
      "vnetName": "[basics('vnetSelector').name]",
      "subnetNames": "[union(array(basics('subnetSelector1')), if(empty(basics('subnetSelector2')), [], array(basics('subnetSelector2'))))]"
    }
  }
}
