{
  "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
  "handler": "Microsoft.Azure.CreateUIDef",
  "version": "0.1.2-preview",
  "parameters": {
    "basics": [
      {
        "name": "vnetSelector",
        "type": "Microsoft.Common.ResourceScope",
        "label": "Select Virtual Network",
        "toolTip": "Choose an existing virtual network.",
        "resourceTypes": [
          "Microsoft.Network/virtualNetworks"
        ],
        "constraints": {
          "required": true,
          "locationFilter": "[resourceGroup().location]"
        },
        "visible": true
      },
      {
        "name": "subnetSelector1",
        "type": "Microsoft.Common.AzureResourceSelector",
        "label": "Select First Subnet",
        "toolTip": "Choose a subnet from the selected virtual network.",
        "resourceType": "Microsoft.Network/virtualNetworks/subnets",
        "options": {
          "filter": {
            "field": "id",
            "contains": "[basics('vnetSelector').name]"
          },
          "select": {
            "labelField": "name",
            "valueField": "name"
          }
        },
        "constraints": {
          "required": true
        },
        "visible": true
      },
      {
        "name": "subnetSelector2",
        "type": "Microsoft.Common.AzureResourceSelector",
        "label": "Select Second Subnet (Optional)",
        "toolTip": "Choose another subnet, if needed.",
        "resourceType": "Microsoft.Network/virtualNetworks/subnets",
        "options": {
          "filter": {
            "field": "id",
            "contains": "[basics('vnetSelector').name]"
          },
          "select": {
            "labelField": "name",
            "valueField": "name"
          }
        },
        "constraints": {
          "required": false
        },
        "visible": true
      }
    ],
    "steps": [],
    "outputs": {
      "vnetName": "[basics('vnetSelector').name]",
      "subnetNames": "[union(array(basics('subnetSelector1')), if(empty(basics('subnetSelector2')), [], array(basics('subnetSelector2'))))]"
    }
  }
}
